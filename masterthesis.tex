\documentclass[
a4paper, 							% Papierformat
%10pt,								% Schriftgröße (12pt, 11pt (Standard))
%twoside,							% Doppelseiten
titlepage,						% Titelei auf eigener Seite
normalheadings,				% Überschriften etwas kleiner (smallheadings)
%idxtotoc,						% Index im Inhaltsverzeichnis
%liststotoc,					% Abb.- und Tab.verzeichnis im Inhalt
%bibtotoc,						% Literaturverzeichnis im Inhalt
%leqno,   						% Nummerierung von Gleichungen links
%fleqn,								% Ausgabe von Gleichungen linksbündig
%draft								% überlangen Zeilen in Ausgabe gekennzeichnet
]
{scrreprt}
\usepackage[ngerman]{babel}
\usepackage[isolatin]{inputenc}
\usepackage{graphicx}
\usepackage{url}
\usepackage{tipa}
\usepackage[left=2.5cm,right=2.5cm,top=2.5cm,bottom=2.5cm,includeheadfoot]{geometry}

\begin{document}



\thispagestyle{empty}
\begin{titlepage}
\begin{figure}[t]
	\centering
  \includegraphics[width=80mm]{images/HsKaLogoKlein.png}
	\vspace{2.5cm}
\end{figure}
\begin{center}
\title{Master-Thesis}
\textbf{\huge{Master-Thesis}} \\[0.5cm]
\textbf{Visual Studio Erweiterung zur statischen Code-Analyse} \\[4cm]
\textbf{andrena objetcs ag} \\[0.25cm]
\author{Manuel Naujoks} Manuel Naujoks\\[2.5cm]
Betreut durch \\[0.25cm] 
Prof. Dr. Thomas Fuchß \\[2.5cm]
Bischweier, den \today
\end{center}
\end{titlepage}



\pagenumbering{roman}
\setcounter{page}{1}
\begin{center}\textbf{\large Erklärung}\\[1cm]\end{center}
Hiermit versichere ich, dass ich die vorliegende Arbeit selbstständig verfasst und keine anderen als die angegebenen Quellen und Hilfsmittel benutzt habe, dass alle Stellen der Arbeit, die wörtlich oder sinngemäß aus anderen Quellen übernommen wurden, als solche kenntlich gemacht sind und dass die Arbeit in gleicher oder ähnlicher Form noch keiner Prüfungsbehörde vorgelegt wurde.
\\[4\baselineskip]
Bischweier, den \today \\
Manuel Naujoks
\newpage



\chapter*{Zusammenfassung}
Im Rahmen dieser Master-Thesis soll eine Visual Studio Erweiterung entwickelt werden, die direktes Entwickler-Feedback anhand von Software-Metriken geben kann. Dabei dient das Plugin Usus für Eclipse als Vorlage, welches bereits existiert. Die zu erstellende Erweiterung soll eine statische Code-Analyse von .NET-Projekten in Visual Stuido 2010 durchführen und für andrena relevante Code-Metriken berechnen können.
\newline
Die zu entwickelnde Erweiterung soll genutzt werden können, um Software-Entwickler aktiv zu unterstützen "`Clean code"' zu schreiben. Eine ähnliche Lösung zu Microsofts Achievements Extension mit Achievements in Bezug auf clean code best practices wäre denkbar. Dazu soll eine Evaluierung anhand von Beispielaufgaben aus einem andrena-Kurs zum Thema Refaktorisierung bearbeitet und die Veränderung in den Metriken entsprechend erfasst und dokumentiert werden.
\newline
Weiterhin soll in einer Metrik-Analyse nach Heuristiken oder Regeln mit statischer Signifikanz gesucht werden, die eventuell guten von schlechtem Code unterscheiden können. Lassen sich hier Muster beziehungsweise Strukturen aufzeigen? Ein Indiz hierfür ist, dass die Metriken oft einer Exponentialverteilung folgen. Dabei soll untersucht werden, ob und wenn möglich wie sich dies auf den Software Qualitäts Index (SQI) von andrena abbilden lässt.
\newpage



\chapter*{Abstract}
Objective of this master thesis is the development of a Visual Studio Extension that is capable of providing direct development feedback based on software metrics. The Eclipse plugin Usus, which already exists, is going to be used as orientation. The extension that is developed shall be able to perform static code analysis of .NET projects in Visual Studio 2010 in order to calculate the code metrics that are relevant for andrena.
\newline
As far as feedback is concerned, the extension shall be able to actively support developers to write "clean code". A similar solution to Microsofts Achievements Extension could likely be found with achievements based on common clean code best practices. Therefore an evaluation with sample exercises of an andrena course on the topic of refactoring is done and the variation in the metrics is detected and documented.
\newline
Another metric analysis is performed in order to find heuristics or rules with static significance, which might be able to distinguish good code from bad code. Are there detectable patterns? One thing might be that metrics often follow an exponential distribution. An analysis shall show whether it is possible and if yes, how this can be mapped to the Software Quality Index (SQI) of andrena.
\newpage




\tableofcontents




\chapter{Einführung}
\pagenumbering{arabic}
\setcounter{page}{1}
todo




\chapter{Grundlagen}
todo


\section{Objektorientierung}
todo


\section{Statische Code-Analyse}
todo


\section{Agile Softwareentwicklung}
Im Jahr 2001 haben sich 17 Softwareentwickler zusammen gesetzt und überlegt, wie bessere Software entwickelt werden kann. Das Ergebnis ist das sogenannte \emph{Agile Manifesto} \cite{AgileManifesto2001}, welches die folgenden vier Werte beinhaltet.
\begin{description}
\item[Individuals and interactions] over processes and tools
\item Working software over comprehensive documentation
\item Customer collaboration over contract negotiation
\item Responding to change over following a plan
\end{description}
Neben diesen Werten nennt das Manifest auch mehrere Prinzipien.
\begin{enumerate} 
\item Vorhandene Resourcen mehrfach verwenden
\item einfach (KISS)
\item zweckmäßig
\item kundennah
\item collective code ownership
\end{enumerate}
In einem agilen Projekt kann laut Ken Schwaber und Jeff Sutherland Scrum zur Planung und Steuerung eingesetzt werden \cite{Scrum2001}. Dabei ist Scrum eine \emph{Methode zum Management von Arbeit in einer sozial komplizierten Umgebung}. In einem Scrum-Projekt, also einem Projekt dessen Projektmanagement mithilfe von Scrum realisiert wird, sind drei Rollen von Bedeutung.
\begin{description}
\item[Scrum Master] Diese Rolle sorgt dafür, das Scrum korrekt verwendet wird, indem Hindernisse entfernt werden.
\item[Product Owner] Diese Rolle bündelt Anforderungen und gibt sie an das Team weiter, ähnlich dem klassischen "`Projektleiter"'. Der Product Owner gibt damit das Ziel des Projekts vor, denn er hat die Vision und die neuen Ideen. Er ist dazu in der Lage, da er aus dem Fachbereich kommt und somit die Anwenderseite vertritt.
\item[Team] Das Team ist selbstorganisierend und auch selbstverantwortlich. Flache beziehungsweise keine Hierarchien sind vorteilhaft.
\end{description}
Weiterhin existieren die folgenden drei wesentlichen Besprechungen.
\begin{description} 
\item[Planung]
\item[Review] Entspricht einer Abnahme und besteht aus direktem Feedback nach einem Sprint, also einer kurzen, geschützten Iteration.
\item[Retrospektive] Dabei handelt es sich um eine Möglichkeit eine kontinuierliche Verbesserung des Prozesses zu erreichen. Im Gegensatz zu Review liegt hier der Fokus auf dem Prozess und nicht auf den Features.
\end{description}
Weiterhin existieren die folgenden drei wesentlichen Dokumente.
\begin{description} 
\item[Produkt Backlog] Priorisierte Aufgabenliste
\item[Sprint Backlog]
\item[Burndown Graph] Fortschrittskontrolle, "`Hauptsache man weiß wo man ist."'
\end{description}


\section{Clean Code}
Die eigentliche Entwicklung der Software wird von Scrum als Projektmanagement-Methode nicht adressiert. Daher wird das Programmieren in einem agilen Projekt durch Praktiken unterstützt, die Martin Fowler in seinem Artikel über die neue Methodik \cite{XP2001} beschreibt. Vier wichtige Bestandteile von XP sind demnach die folgenden.
\begin{enumerate} 
\item automatisiertes Testen
\item ständiges Refactoring
\item schnelle Code reviews
\item continous integration
\end{enumerate}




\chapter{Usus}
Bedeutung: "`das, was üblich ist"'

\section{Eclipse Plugin}
Das Plugin existiert bereits für die Java IDE Eclipse.

\section{Metriken}
Das Plugin berechnet die folgenden Metriken.
\begin{enumerate} 
\item Average component dependency
\item Class size
\item Cyclomatic complexity
\item Method length
\item Number of non-static, non-final public fields
\item Packages with cyclic dependencies
\end{enumerate}




\chapter{Anforderungen}
Was muss gemacht werden?




\chapter{Vorgehensweise}
\begin{enumerate} 
\item Evaluierung der geeignetsten Technologie.
\item Implementierung der Code-Analyse zur Berechnung der Metriken.
\item Implementierung der Visual Studio Erweiterung zur Anzeige der Ergebnisse.
\end{enumerate}




\chapter{Technologie Evaluierung}
Folgende Kriterien:
\begin{enumerate} 
\item What is the target? //code or assembly
\item Access to information required to calculate metrics?
\item Does it work with unresolved references?
\item Can it be hosted in a single executable?
\item Can it be used for more than C$\#$ only?
\item Does it support all .NET runtimes?
\item What is the (performance) overhead?
\end{enumerate}

\section{System.Reflection}

\section{FxCop}

\section{Common Compiler Infrastracture}

\section{NRefactory}

\section{Codename "`Roslyn"'}

\section{Zusammenfassung}
Mit Ergebnis aka welche Technologie für die statische Codeanalyse verwendet werden soll.




\chapter{Metrik-Berechnung}
todo




\chapter{Visual Studio Erweiterung}
todo




\chapter{Entwickler-Feedback}
todo


\section{Achievements System}
todo


\section{Fallbeispiel Andrena-Kurs}
todo




\chapter{Metrik-Analyse}
todo


\section{Heuristiken}
todo


\section{Exponentialverteilungen}
todo


\section{Andrena Software Qualitäts Index}
todo




\chapter{Zusammenfassung}
todo




\chapter{Fazit}
todo









\bibliography{masterthesis}
\bibliographystyle{alpha}

\end{document}
